const assert = require('assert')
const mocha = require('mocha')

const { createDigitsFromOne } = require('./utils')
const getHosts = require('./')

const digits = createDigitsFromOne(9)

/** Desired output for r = 3 **/
const expectation = [
	{
		hosts: [
			{ host: 'ndb-01', port: 27017 },
			{ host: 'ndb-02', port: 27018 },
			{ host: 'ndb-03', port: 27019 }
		],
		repSet: 'r-01'
	}, {
		hosts:
			[
				{ host: 'ndb-02', port: 27017 },
				{ host: 'ndb-03', port: 27018 },
				{ host: 'ndb-01', port: 27019 }
		],
		repSet: 'r-02'
	}, {
		hosts: [
			{ host: 'ndb-03', port: 27017 },
			{ host: 'ndb-01', port: 27018 },
			{ host: 'ndb-02', port: 27019 }
		],
		repSet: 'r-03'
	}, {
		hosts: [
			{ host: 'ndb-04', port: 27017 },
			{ host: 'ndb-05', port: 27018 },
			{ host: 'ndb-06', port: 27019 }
		],
		repSet: 'r-04'
	}, {
		hosts: [
			{ host: 'ndb-05', port: 27017 },
			{ host: 'ndb-06', port: 27018 },
			{ host: 'ndb-04', port: 27019 }
		],
		repSet: 'r-05'
	}, {
		hosts: [
			{ host: 'ndb-06', port: 27017 },
			{ host: 'ndb-04', port: 27018 },
			{ host: 'ndb-05', port: 27019 }
		],
		repSet: 'r-06'
	}, {
		hosts: [
			{ host: 'ndb-07', port: 27017 },
			{ host: 'ndb-08', port: 27018 },
			{ host: 'ndb-09', port: 27019 }
		],
		repSet: 'r-07'
	}, {
		hosts: [
			{ host: 'ndb-08', port: 27017 },
			{ host: 'ndb-09', port: 27018 },
			{ host: 'ndb-07', port: 27019 }
		],
		repSet: 'r-08'
	}, {
		hosts: [
			{ host: 'ndb-09', port: 27017 },
			{ host: 'ndb-07', port: 27018 },
			{ host: 'ndb-08', port: 27019 }
		],
		repSet: 'r-09'
	}
]

describe('produce storages', function() {
	it('should be right for r === 3', function() {
		digits.forEach((digit) => {
			assert.deepEqual(getHosts(digit, 3), expectation[digit - 1], `Expectation did not match result for digit: ${digit}.`)
		})
	})
})
